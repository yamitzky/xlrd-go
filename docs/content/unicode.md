---
title: "Handling Unicode"
description: "How text encodings are handled for legacy XLS files."
---

Excel 97 and later store text in UTF-16LE. Older files store text in a
legacy code page. The `CODEPAGE` record provides the code page number (for
example, 1252), which xlrd uses to derive the encoding (for the same
example: `cp1252`).

If the `CODEPAGE` record is missing (possible in files generated by third-party
software), xlrd assumes `ascii` and continues. If the actual encoding is not
ASCII, a decoding error will be raised and you will need to supply the correct
encoding manually:

```go
book, err := xlrd.OpenWorkbook("myfile.xls", &xlrd.OpenWorkbookOptions{
    EncodingOverride: "cp1252",
})
```

If the `CODEPAGE` record exists but is wrong (for example, it says 1251 but the
strings are actually encoded in `koi8_r`), you can override it using the same
mechanism.

The first place to look for an encoding name is the standard codec list, which
maps well to the encoding names used by this project:
https://docs.python.org/library/codecs.html#standard-encodings
